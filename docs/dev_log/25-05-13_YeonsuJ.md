# 개발 일지 - 2025-05-14 (수)

## ✅ 오늘의 작업 내용
- [x] DC 모터 PWM 제어 개선
- [x] PD1 (브레이크), PD2 (방향 스위치) 인터럽트 동작 테스트
- [ ] UART 디버깅 로그 추가 (미완)

## ⚙️ 하드웨어 변경 사항
- 엔코더 전원 연결 위치를 5V → 3.3V로 변경 (STM32 GPIO 보호 목적)
- L298N 드라이버의 ENA 핀을 PA5 → PB0으로 변경 (PWM 채널 변경 대응)

## ⚠️ 문제 및 시행착오
| 문제 | 원인 분석 | 해결 방법 |
|------|------------|------------|
| 방향 전환 시 가속 중에도 반응함 | 인터럽트가 우선순위 상위에 존재 | `accel_pressed` 상태 확인 후 방향 변경 허용 |
| 브레이크 스위치 입력 지연 | 풀업 저항 미삽입 | 외부 10kΩ 풀업 저항 추가 |

## 📷 하드웨어 사진 / 회로도
- `media/pd1_switch_test.jpg`
- `docs/hardware_connections/connection_v2.drawio`

## 🧪 테스트 결과 요약
- PWM 70% 이상에서 모터 진동 증가 → 전원 부족 의심
- 인터럽트 핀 디바운싱 필요성 판단 (스위치 노이즈 관측됨)

## 🗓️ 내일 목표
- [ ] 디바운싱 구현 (타이머 or 소프트웨어 방식)
- [ ] PWM 듀티별 전류 측정 및 로그 기록
- [ ] UART 기반 상태 출력 기능 추가


+

docs/hardware_connections/connection_v2.drawio

Draw.io 또는 Fritzing으로 만든 배선도/회로도 저장

Git LFS를 사용하면 .drawio, .png, .pdf 등 고용량도 문제 없음



